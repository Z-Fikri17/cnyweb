<!DOCTYPE html>
<html lang="en" x-data="productsApp()">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details</title>

  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>

</head>
<body>

  <!-- Navbar -->
  <div id="navbar"></div>

  <!-- Product Details -->
<div x-show="product"
     class="max-w-6xl mx-auto p-6 md:p-10 bg-white rounded-3xl shadow-xl grid md:grid-cols-2 gap-10 items-start">

  <!-- Product Image -->
<div class="relative">
  <!-- Prime Pick Badge -->

  <img :src="product.image"
       class="w-full h-[380px] object-cover rounded-2xl border">
</div>

  <!-- Product Info -->
  <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-2"
    x-text="product.name"></h1>
  <p class="text-2xl text-green-600 font-semibold mb-4"
   x-text="product.price"></p>

  <!-- Product Details -->
  <ul class="list-disc list-inside text-black-300 mb-6 space-y-1">
    <template x-for="d in product.details" :key="d">
      <li x-text="d"></li>
    </template>
  </ul>

  <!-- Stock & Sold -->
  <div class="flex flex-col justify-between">
    <span x-text="`Stock: ${product.stock}`"></span>
    <span x-text="`Sold: ${product.sold}`"></span>
  </div>

<!-- Order Button -->
<!-- Checkout Button -->
<button id="checkoutBtn"
        class="inline-block bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-full font-semibold">
  Checkout with HitPay
</button>

<!-- Customer Info Modal -->
<div id="customerModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-gray-800 rounded-2xl p-6 max-w-lg w-full relative shadow-2xl">
    <button id="closeModal" class="absolute top-3 right-3 text-white text-xl">&times;</button>
    <h2 class="text-2xl font-bold mb-4 text-white">Customer Information</h2>

    <form id="customerForm" class="space-y-4">
      <input type="text" name="name" placeholder="Full Name" required
             class="w-full p-2 rounded text-black">
      <input type="tel" name="phone" placeholder="Phone" required
             class="w-full p-2 rounded text-black">
      <textarea name="address" placeholder="Delivery Address" required
                class="w-full p-2 rounded text-black"></textarea>
      <button type="submit"
              class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-full font-semibold w-full">
        Confirm and Checkout
      </button>
    </form>
  </div>
</div>

<script>
  const checkoutBtn = document.getElementById('checkoutBtn');
  const modal = document.getElementById('customerModal');
  const closeModal = document.getElementById('closeModal');

  // Original HitPay link (sandbox)
  const HITPAY_BASE_URL = 'https://securecheckout.sandbox.hit-pay.com/payment-request/@megah-holding';

  // Show modal on checkout click
  checkoutBtn.addEventListener('click', () => {
    modal.classList.remove('hidden');
  });

  // Close modal
  closeModal.addEventListener('click', () => {
    modal.classList.add('hidden');
  });

  // Submit form
  const form = document.getElementById('customerForm');
  form.addEventListener('submit', function(e) {
    e.preventDefault();

    // Collect customer info
    const formData = new FormData(this);
    const name = formData.get('name');
    const phone = formData.get('phone');
    const address = formData.get('address');

    // Combine into one notes string
    const notes = `Name: ${name}\nPhone: ${phone}\nAddress: ${address}`;

    // Encode for URL
    const encodedNotes = encodeURIComponent(notes);

    // Build final HitPay link with notes query param
    const finalURL = HITPAY_BASE_URL + `?notes=${encodedNotes}`;

    // Open HitPay in new tab
    window.open(finalURL, '_blank');

    // Close modal
    modal.classList.add('hidden');
  });
</script>

</body>
<script src="main.js"></script>
</html>
